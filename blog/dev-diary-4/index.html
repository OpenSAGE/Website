<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/component---src-templates-post-js.d2ac1a46b4834ac760cb.css">@import url(https://fonts.googleapis.com/css?family=Noto+Serif+TC|Source+Code+Pro);*{box-sizing:border-box}body,html{margin:0;padding:0;min-height:100%;display:flex;width:100%}body{font-family:"Noto Serif TC",serif;font-size:16px;line-height:1.6}h1{margin-top:2em}h2{margin-top:1.5em;margin-bottom:.5em}#___gatsby,#___gatsby>div{display:flex;height:100%;width:100%}.page{max-width:100%}#main-content,.page{display:flex;flex-direction:column;flex-grow:1;width:100%}#main-content{flex-shrink:0;padding-left:2em;padding-right:2em;margin-left:auto;margin-right:auto;margin-bottom:40px;max-width:700px}.row{display:flex;flex-direction:row;flex-shrink:0}.row+.row{margin-top:16px}.width-50{max-width:50%;flex-shrink:0}.responsive-image{display:flex;flex-shrink:1;max-width:100%}.responsive-image+.responsive-image,.responsive-image-container+.responsive-image-container{margin-left:16px}@media screen and (max-width:450px){.row{flex-direction:column}.responsive-image,.responsive-image+.responsive-image,.responsive-image-container+.responsive-image-container{margin-top:16px;margin-left:0}}footer{background:#000;color:#fff;font-size:12px}.footer__content{max-width:900px;margin-left:auto;margin-right:auto;padding:8px}.header__logo{height:100px;min-height:80px;background:url(/opensage-logo.png);background-size:contain;background-position:50%;background-repeat:no-repeat}.navbar{border-bottom:2px solid #000}.navbar__items{margin:0 auto 16px;list-style:none;display:flex;flex-direction:row;justify-content:center}.nav-item{display:inline-flex}.nav-item:not(last-child){margin-right:40px}.nav-item a{color:#000;text-decoration:none}.nav-item a:hover{text-decoration:underline}.post-content img{max-width:100%}.post-content h2>a,.post-content h3>a{text-decoration:none;color:initial}.post-content li,.post-content p{text-align:justify}.post-content blockquote{border-left:4px solid #d3d3d3;padding-left:1em;margin-left:0}.post-content pre{color:#333;background:#eee;padding:1em;overflow-x:auto}.post-content pre code{line-height:1.2;font-size:.8rem}.post-content code,.post-content pre code{font-family:Source Code Pro,Menlo,Consolas,monospace}.post-content code{background:#eee;color:#333;padding:2px 4px}.post-metadata span{display:block}.post-metadata__author{font-weight:700}.post-content .video-responsive{overflow:hidden;padding-bottom:56.25%;position:relative;height:0}.post-content .video-responsive>iframe{position:absolute;top:0;left:0;width:100%;height:100%}.post-content .table-wrapper{max-width:100%;overflow-x:auto;border:1px solid #bdc1c4}.post-content table{border-collapse:collapse}.post-content table th{background-color:#f0f0f0;padding-left:1em;padding-right:1em;width:auto}.post-content table td,.post-content table th{border-bottom:1px solid #bdc1c4;border-right:1px solid #ccc;padding:.5rem;white-space:nowrap}</style><style data-href="/0.24bf1742e3764eb5de3c.css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}</style><meta name="generator" content="Gatsby 2.0.73"/><title data-react-helmet="true">OpenSAGE Dev Diary #4 - OpenSAGE</title><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link as="script" rel="preload" href="/webpack-runtime-436110e57a4d83c352e9.js"/><link as="script" rel="preload" href="/app-a59aed0f94aff211795a.js"/><link as="script" rel="preload" href="/0-fdb546639c1c10770604.js"/><link as="script" rel="preload" href="/1-d8e8b120a95f8cf248dc.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-4766c8b33af9fb1664ca.js"/><link as="fetch" rel="preload" href="/static/d/713/path---blog-dev-diary-4-143-3f0-VxjOLkFjuvMCvMCEv5lKcP8FWHs.json" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="page"><header><a href="/"><div class="header__logo"></div></a><nav class="navbar"><ol class="navbar__items"><li class="nav-item"><a href="/">About</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="https://github.com/OpenSAGE/OpenSAGE">GitHub</a></li><li class="nav-item"><a href="https://discord.gg/G2FhZUT">Discord</a></li></ol></nav></header><div id="main-content"><h1>OpenSAGE Dev Diary #4</h1><div class="post-metadata"><span class="post-metadata__author">Tim Jones</span><span class="post-metadata__date">24 December 2017</span></div><div class="post-content"><p><em><a href="http://timjones.io/blog/archive/2017/12/24/opensage-dev-diary-4-2017-12-24">This post</a> was originally published on Tim's blog.</em></p>
<p><em>OpenSAGE is an open-source re-implementation of the <a href="https://en.wikipedia.org/wiki/SAGE_(game_engine)">SAGE game engine</a>. SAGE was the game engine used in C&#x26;C Generals, C&#x26;C Generals Zero Hour, Battle for Middle-earth and its sequels, C&#x26;C 3 and its sequel, and Red Alert 3 and its sequel. I've been working on OpenSAGE for 6 months, and made some good progress, so I've started this series of blog posts to talk about what is happening in the project each week. You can also star or watch the <a href="https://github.com/OpenSAGE/OpenSAGE">OpenSAGE GitHub repo</a> for a more real-time view of things.</em></p>
<p>Following on from <a href="/blog/archive/2017/12/17/opensage-dev-diary-3-2017-12-17">last week's post</a>, here is what's been happening this week in <a href="https://github.com/OpenSAGE/OpenSAGE">OpenSAGE</a>.</p>
<h2 id="progress-this-week">Progress this week</h2>
<div class="video-responsive">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/ZcH15Eeh8Ng" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe>
</div>
<p>This week in OpenSAGE:</p>
<ul>
<li>
<p>I've worked on UI rendering, in particular the main menu. The main menu now responds to mouse input, and you can click buttons. C&#x26;C Generals <code>.wnd</code> files use a callback system, and those callbacks are implemented in engine code, so I'm having to guess at their implementations just from observing behaviour in the running game. For example, when you first see the main menu, only the logo is visible, but then after any mouse (or keyboard) input, the border and buttons animate in. As far as I can tell that is done in the <code>MainMenuInput</code> callback. Every UI element (or "window" as they're called in <code>.wnd</code> files) has an input callback and a system callback. If it's not specified in the <code>.wnd</code> file, then the engine appears to use default callbacks based on window type (button, textbox, etc.). The input callback receives mouse and keyboard messages, and turns them into "system" messages like "the skirmish button was pressed", and these system messages are passed to the system callback. One of the system callbacks is <code>PassMessagesToParentSystem</code>, which passes any messages to the system callback of the parent window. In most <code>.wnd</code> files I've looked at so far, eventually at the top level, the <code>.wnd</code> defines a system callback that actually does something. The design seems heavily inspired by win32 window messages, but it's not the same.</p>
</li>
<li>
<p><a href="https://github.com/feliwir">Stephan Vedder</a> submitted another great <a href="https://github.com/OpenSAGE/OpenSAGE/pull/12">pull request</a>, this time adding initial support for the <code>.apt</code> format, used to define UI screens in Battle for Middle-earth (BFME) and later SAGE games.</p>
</li>
</ul>
<p>Just a short update this week. Until next time!</p></div></div><footer><div class="footer__content"><p>OpenSAGE is an open source project and not associated with Electronic Arts or any other company. All trademarks are property of their respective owners. Screenshots of copyrighted works are only used for demonstration purposes.</p><p>© OpenSAGE <!-- -->2018</p></div></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-js","jsonName":"blog-dev-diary-4-143","path":"/blog/dev-diary-4"};window.dataPath="713/path---blog-dev-diary-4-143-3f0-VxjOLkFjuvMCvMCEv5lKcP8FWHs";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-a59aed0f94aff211795a.js"],"component---src-templates-post-js":["/component---src-templates-post-js.d2ac1a46b4834ac760cb.css","/component---src-templates-post-js-4766c8b33af9fb1664ca.js"],"component---src-pages-404-js":["/component---src-pages-404-js-7f310243cc7626c49131.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js.da8e6e846b6d400a4985.css","/component---src-pages-blog-js-137500fdf0b4bfff2e59.js"],"component---src-pages-index-js":["/component---src-pages-index-js.da8e6e846b6d400a4985.css","/component---src-pages-index-js-ee9a0e788f0505c4fc01.js"]};/*]]>*/</script><script src="/component---src-templates-post-js-4766c8b33af9fb1664ca.js" async=""></script><script src="/1-d8e8b120a95f8cf248dc.js" async=""></script><script src="/0-fdb546639c1c10770604.js" async=""></script><script src="/app-a59aed0f94aff211795a.js" async=""></script><script src="/webpack-runtime-436110e57a4d83c352e9.js" async=""></script></body></html>